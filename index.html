<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title></title>
  <link rel="stylesheet" href="./css/ClearStyle.css">
  <link rel="stylesheet" href="./css/CommonCss.css">
  <link rel="stylesheet" href="./css/Head.css">
  <link rel="stylesheet" href="./css/Content.css">
  <link rel="stylesheet" href="./css/ScreenOne.css">
  <link rel="stylesheet" href="./css/ScreenTwo.css">
  <link rel="stylesheet" href="./css/ScreenThree.css">
  <link rel="stylesheet" href="./css/ScreenFour.css">
  <link rel="stylesheet" href="./css/ScreenFive.css">
  <style>

  </style>
</head>

<body>
  <section id="wrap">
    <div id="enter">ENTER</div>
    <!-- 遮罩层 -->
    <div id="mask">
      <div class="up"></div>
      <div class="line"></div>
      <div class="down"></div>
    </div>
    <!-- 流体布局 -->
    <header id="head">
      <!-- 固定布局 -->
      <div class="headMain">
        <h1 class="logo">
          <a href="javascript:;">
            <img src="./img/logo.png">
          </a>
        </h1>
        <nav class="nav">
          <ul class="list clearfix">
            <li><a href="javascript:;">
                <div class="up">
                  <img src="./img/home_gruen.png">
                </div>
                <div class="down">
                  <img src="./img/home.png">
                </div>
              </a></li>
            <li><a href="javascript:;">
                <div class="up">Course</div>
                <div class="down">Course</div>
              </a></li>
            <li><a href="javascript:;">
                <div class="up">Works</div>
                <div class="down">Works</div>
              </a></li>
            <li><a href="javascript:;">
                <div class="up">About</div>
                <div class="down">About</div>
              </a></li>
            <li><a href="javascript:;">
                <div class="up">Team</div>
                <div class="down">Team</div>
              </a></li>
          </ul>
        </nav>
        <div class="arrow"></div>
        <div class="music">
          <audio src="./Fideles - Interface Technology.mp3" loop></audio>
        </div>

      </div>
    </header>
    <!-- 内容区 -->
    <section id="content">
      <ul class="list">
        <li class="home">
          <section>
            <ul class="home1">
              <li class="commonTitle active">
                <div class="item">one layer</div>
              </li>
              <li class="commonTitle">
                <div class="item">two layer</div>
              </li>
              <li class="commonTitle">
                <div class="item">three layer</div>
              </li>
              <li class="commonTitle">
                <div class="item">four layer</div>
              </li>
            </ul>
            <ul class="home2 dot">
              <li class="active"></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </section>
        </li>
        <li class="course">
          <section>
            <header class="course1 commonTitle">
              <span>EINIGE</span><br>
              <span>UNSERER</span><br>
              <span>KUNDEN</span><br>
            </header>
            <div class="course2 commonText">
              <p>
                Sed et eveniet ut quia at beatae nisi quibusdam consectetur, laboriosam dignissimos sapiente
                necessitatibus molestias! Soluta omnis aut, nam nisi architecto pariatur.
                <br>
                Ratione, assumenda? Quam recusandae eum sequi nam necessitatibus nemo fugiat praesentium debitis qui
                architecto voluptas, velit cumque reiciendis libero consequuntur et saepe?
              </p>
              <div class="course3">
                <span class="line"></span>
                <span class="line"></span>
                <span class="line"></span>
                <span class="line"></span>
                <span class="line"></span>
                <div class="item">
                  <div class="backface"></div>
                  <div class="face">Lorem ipsum, dolor sit amet consectetur adipisicing elit.</div>
                </div>
                <div class="item">
                  <div class="backface"></div>
                  <div class="face">Lorem ipsum, dolor sit amet consectetur adipisicing elit.</div>
                </div>
                <div class="item">
                  <div class="backface"></div>
                  <div class="face">Lorem ipsum, dolor sit amet consectetur adipisicing elit.</div>
                </div>
                <div class="item">
                  <div class="backface"></div>
                  <div class="face">Lorem ipsum, dolor sit amet consectetur adipisicing elit.</div>
                </div>
                <div class="item">
                  <div class="backface"></div>
                  <div class="face">Lorem ipsum, dolor sit amet consectetur adipisicing elit.</div>
                </div>
                <div class="item">
                  <div class="backface"></div>
                  <div class="face">Lorem ipsum, dolor sit amet consectetur adipisicing elit.</div>
                </div>
                <div class="item">
                  <div class="backface"></div>
                  <div class="face">Lorem ipsum, dolor sit amet consectetur adipisicing elit.</div>
                </div>
                <div class="item">
                  <div class="backface"></div>
                  <div class="face">Lorem ipsum, dolor sit amet consectetur adipisicing elit.</div>
                </div>
                <div class="item">
                  <div class="backface"></div>
                  <div class="face">Lorem ipsum, dolor sit amet consectetur adipisicing elit.</div>
                </div>
                <div class="item">
                  <div class="backface"></div>
                  <div class="face">Lorem ipsum, dolor sit amet consectetur adipisicing elit.</div>
                </div>
                <div class="item">
                  <div class="backface"></div>
                  <div class="face">Lorem ipsum, dolor sit amet consectetur adipisicing elit.</div>
                </div>
                <div class="item">
                  <div class="backface"></div>
                  <div class="face">Lorem ipsum, dolor sit amet consectetur adipisicing elit.</div>
                </div>
              </div>
            </div>
            <div class="plane1"></div>
            <div class="plane2"></div>
            <div class="plane3"></div>
          </section>
        </li>
        <li class="works">
          <section>
            <header class="works1 commonTitle">
              <span>EINBLICK</span><br>
              <span>ERKENNTNIS</span><br>
              <span>ERGEBNIS</span><br>
            </header>
            <div class="works2">
              <div class="item">
                <img src="./img/worksimg1.jpg">
                <div class="mask">
                  <span>Lorem ipsum dolor sit, amet consectetur adipisicing elit.</span>
                  <div class="icon"></div>
                </div>
              </div>
              <div class="item">
                <img src="./img/worksimg2.jpg">
                <div class="mask">
                  <span>Lorem ipsum dolor sit amet consectetur adipisicing elit.</span>
                  <div class="icon"></div>
                </div>
              </div>
              <div class="item">
                <img src="./img/worksimg3.jpg">
                <div class="mask">
                  <span>Lorem ipsum dolor sit, amet consectetur adipisicing elit. Odit, ea ipsa?</span>
                  <div class="icon"></div>
                </div>
              </div>
              <div class="item">
                <img src="./img/worksimg4.jpg">
                <div class="mask">
                  <span>Lorem ipsum dolor sit, amet.</span>
                  <div class="icon"></div>
                </div>
              </div>
            </div>
            <div class="works3"></div>
            <div class="pencil1"></div>
            <div class="pencil2"></div>
            <div class="pencil3"></div>
          </section>
        </li>
        <li class="about">
          <section>
            <header class="about1 commonTitle">
              <span>DIE</span><br>
              <span>SPEZIELLE</span><br>
              <span>VIELFALT</span><br>
            </header>
            <div class="about2 commonText">
              <p>
                Sed et eveniet ut quia at beatae nisi quibusdam consectetur, laboriosam dignissimos sapiente
                necessitatibus molestias! Soluta omnis aut, nam nisi architecto pariatur.
                <br>
                Ratione, assumenda? Quam recusandae eum sequi nam necessitatibus nemo fugiat praesentium debitis qui
                architecto voluptas, velit cumque reiciendis libero consequuntur et saepe?
              </p>
            </div>
            <div class="about3">
              <div class="item">
                <div></div>
                <ul data-src="./img/about1.jpg"></ul>
              </div>
              <div class="item">
                <div></div>
                <ul data-src="./img/about3.jpg"></ul>
              </div>
            </div>
            <div class="about4"></div>
          </section>
        </li>
        <li class="team ">
          <section>
            <header class="team1 commonTitle">
              <span>WIR SIND</span><br>
              <span>VOXELAIR</span><br>
            </header>
            <div class="team2 commonText">
              <p>
                Sed et eveniet ut quia at beatae nisi quibusdam consectetur, laboriosam dignissimos sapiente
                necessitatibus molestias! Soluta omnis aut, nam nisi architecto pariatur.
                <br>
                Ratione, assumenda? Quam recusandae eum sequi nam necessitatibus nemo fugiat praesentium debitis qui
                architecto voluptas, velit cumque reiciendis libero consequuntur et saepe?
              </p>
            </div>
            <ul class="team3">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </section>
        </li>
      </ul>
      <ul class="dot">
        <li class="active"></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
      </ul>
    </section>
  </section>
</body>
<script>
  window.onload = function () {
    // 获取dom元素
    let arrow = document.querySelector("#head .headMain> .arrow")
    let lis = document.querySelectorAll("#head .headMain> .nav> .list> li ")

    let head = document.querySelector("#head")
    let content = document.querySelector("#content")
    let clis = document.querySelectorAll("#content .list> li")
    let clist = document.querySelector("#content .list")

    let home = document.querySelector("#content .list> .home .home1")
    let piclis = document.querySelectorAll("#content .list> .home .home1> li")
    let poilis = document.querySelectorAll("#content .list> .home .home2> li")

    let auls = document.querySelectorAll("#content .list>.about .about3> .item>ul")

    let dlis = document.querySelectorAll("#content> .dot>li")

    let tul = document.querySelector("#content>.list>.team .team3")
    let tlis = document.querySelectorAll("#content>.list>.team .team3>li")
    let t3 = document.querySelector("#content>.list>.team .team3")

    let audio = document.querySelector("audio")
    let music = document.querySelector("#head> .headMain .music")

    let mask = document.querySelector("#mask")
    let line = document.querySelector("#mask .line")
    let up = document.querySelector("#mask .up")
    let down = document.querySelector("#mask .down")
    let enter = document.querySelector("#enter")


    //出入场动画
    let anime = [
      {
        inan: function () {
          let home1 = document.querySelector("#content .list> .home .home1")
          let home2 = document.querySelector("#content .list> .home .home2")

          home1.style.transform = "translateY(0px)"
          home1.style.opacity = "1"

          home2.style.transform = "translateY(0px)"
          home2.style.opacity = "1"
        },
        outan: function () {
          let home1 = document.querySelector("#content .list> .home .home1")
          let home2 = document.querySelector("#content .list> .home .home2")

          home1.style.transform = "translateY(-400px)"
          home1.style.opacity = "0"

          home2.style.transform = "translateY(100px)"
          home2.style.opacity = "0"
        }
      },
      {
        inan: function () {
          let plane1 = document.querySelector("#content>.list>.course .plane1")
          let plane2 = document.querySelector("#content>.list>.course .plane2")
          let plane3 = document.querySelector("#content>.list>.course .plane3")

          plane1.style.transform = "translate(0px, 0px)"
          plane2.style.transform = "translate(0px, 0px)"
          plane3.style.transform = "translate(0px, 0px)"
        },
        outan: function () {
          let plane1 = document.querySelector("#content>.list>.course .plane1")
          let plane2 = document.querySelector("#content>.list>.course .plane2")
          let plane3 = document.querySelector("#content>.list>.course .plane3")

          plane1.style.transform = "translate(-200px, -200px)"
          plane2.style.transform = "translate(-200px, 200px)"
          plane3.style.transform = "translate(200px, -200px)"
        }
      },
      {
        inan: function () {
          let pencil1 = document.querySelector("#content>.list>.works .pencil1")
          let pencil2 = document.querySelector("#content>.list>.works .pencil2")
          let pencil3 = document.querySelector("#content>.list>.works .pencil3")

          pencil1.style.transform = "translateY(0px)"
          pencil2.style.transform = "translateY(0px)"
          pencil3.style.transform = "translateY(0px)"
        },
        outan: function () {
          let pencil1 = document.querySelector("#content>.list>.works .pencil1")
          let pencil2 = document.querySelector("#content>.list>.works .pencil2")
          let pencil3 = document.querySelector("#content>.list>.works .pencil3")

          pencil1.style.transform = "translateY(-150px)"
          pencil2.style.transform = "translateY(150px)"
          pencil3.style.transform = "translateY(150px)"
        }
      },
      {
        inan: function () {
          let item1 = document.querySelector("#content .list>.about .about3> .item:nth-child(1)")
          let item2 = document.querySelector("#content .list>.about .about3> .item:nth-child(2)")

          item1.style.transform = "rotate(0deg)"
          item2.style.transform = "rotate(0deg)"
        },
        outan: function () {
          let item1 = document.querySelector("#content .list>.about .about3> .item:nth-child(1)")
          let item2 = document.querySelector("#content .list>.about .about3> .item:nth-child(2)")

          item1.style.transform = "rotate(25deg)"
          item2.style.transform = "rotate(-25deg)"
        }
      },
      {
        inan: function () {
          let team1 = document.querySelector("#content>.list>.team .team1")
          let team2 = document.querySelector("#content>.list>.team .team2")

          team1.style.transform = "translateX(0px)"
          team2.style.transform = "translateX(0px)"
        },
        outan: function () {
          let team1 = document.querySelector("#content>.list>.team .team1")
          let team2 = document.querySelector("#content>.list>.team .team2")

          team1.style.transform = "translateX(-150px)"
          team2.style.transform = "translateX(150px)"
        }
      },
    ]
    for (let i = 0; i < lis.length; i++) {
      anime[i].outan()
    }

    //工具类
    let tools = {
      //箭头移动函数
      moveArrow: function (liNode) {
        liNode.querySelector(".up").style.width = "100%"
        arrow.style.left = liNode.offsetLeft + liNode.offsetWidth / 2 - arrow.offsetWidth / 2 + "px"
      },
      //内容区移动函数
      moveContent: function (i, lis) {
        for (let i = 0; i < lis.length; i++) lis[i].querySelector(".up").style.width = ""
        this.moveArrow(lis[i])
        clist.style.top = -i * (document.documentElement.clientHeight - head.offsetHeight) + "px"
        for (let i = 0; i < lis.length; i++) {
          anime[i].outan()
        }
        anime[i].inan()
        now = i
      },
      //滚轮方向判断函数
      scrollDir: function (e) {

        let dir = ""
        if (e.wheelDelta) dir = e.wheelDelta > 0 ? "up" : "down"
        else if (e.detail) dir = e.wheelDelta < 0 ? "up" : "down"

        switch (dir) {
          case "up":
            if (now > 0) {
              now--
              tools.moveContent(now, lis)
              tools.dotChange(now)
            }
            break
          case "down":
            if (now < clis.length - 1) {
              now++
              tools.moveContent(now, lis)
              tools.dotChange(now)
            }
            break
        }
      },
      //右侧导航变换函数
      dotChange(i) {
        for (let j = 0; j < dlis.length; j++) {
          dlis[j].classList.remove("active")
        }
        dlis[i].classList.add("active")
      }
    }

    //开屏动画
    // loading()
    enter.onclick = function () {
      loading()
      enter.remove()
    }
    function loading() {
      //模拟读取文件
      var arr = ['bg1.jpg', 'bg2.jpg', 'bg3.jpg', 'bg4.jpg', 'bg5.jpg', 'about1.jpg', 'about2.jpg', 'about3.jpg', 'about4.jpg', 'worksimg1.jpg', 'worksimg2.jpg', 'worksimg3.jpg', 'worksimg4.jpg', 'team.png', 'greenLine.png'];
      let flag = 0
      for (let i = 0; i < arr.length; i++) {
        let img = new Image()
        img.src = `./img/${arr[i]}`
        img.onload = function () {
          flag++
          line.style.width = flag / arr.length * 100 + "%"
        }
      }
      line.addEventListener("transitionend", function () {
        if (flag === arr.length) {
          up.style.height = 0 + "px"
          down.style.height = 0 + "px"
          this.style.display = "none"
        }
      })
      up.addEventListener("transitionend", function () {
        anime[0].inan()
        mask.remove()
        setTimeout(() => {
          audio.volume = 0.3
          audio.play()
        }, 50);
        home3D()
      })
    }


    //音频控件
    music.onclick = function () {
      if (audio.paused) {
        audio.play()
        music.style.background = "url(./img/musicon.gif)"
      } else {
        audio.pause()
        music.style.background = "url(./img/musicoff.gif)"
      }
    }



    //头部导航栏行为
    headBind()
    function headBind() {
      //给所有菜单项绑定箭头移动
      for (let i = 0; i < lis.length; i++) {
        lis[i].onclick = function () {
          tools.moveContent(i, lis)
          tools.dotChange(i)
        }
      }

      //默认开启时箭头位于第一个菜单项
      let firstLi = lis[0]
      firstLi.querySelector(".up").style.width = "100%"
      tools.moveArrow(firstLi)
    }


    //内容区行为
    //当前屏索引
    let now = 0
    //防抖阀
    let timer = 0
    contentBind()
    function contentBind() {
      //每一屏大小适应
      content.style.height = document.documentElement.clientHeight - head.offsetHeight + "px"
      for (let i = 0; i < clis.length; i++) {
        clis[i].style.height = document.documentElement.clientHeight - head.offsetHeight + "px"
      }

      //右侧导航点
      for (let i = 0; i < dlis.length; i++) {
        dlis[i].addEventListener("click", function () {
          tools.dotChange(i)
          tools.moveContent(i, lis)
        }, false)
      }
    }
    //兼容火狐
    if (content.addEventListener) content.addEventListener("DOMMouseScroll", scrollContent)
    content.onmousewheel = scrollContent
    function scrollContent(e) {
      e = e || event

      clearTimeout(timer)
      timer = setTimeout(() => {
        tools.scrollDir(e)
      }, 100);
    }
    //分辨率适应
    window.addEventListener("resize", function () {
      //调整分辨率
      //1.视口只能出现一屏
      //2.点击后每一屏的偏移量需要重新调整
      //3.小箭头的位置也要同步
      contentBind()
      clist.style.top = -now * (document.documentElement.clientHeight - head.offsetHeight) + "px"
      tools.moveArrow(lis)
    })


    //第一屏3d效果
    //旧坐标
    let oldIndex = 0
    //自动轮播定时器
    let timer3D = 0
    //自动轮播坐标
    let autoIndex = 0
    // home3D()
    function home3D() {
      //圆点事件
      for (let i = 0; i < poilis.length; i++) {
        poilis[i].onclick = function () {
          for (let j = 0; j < poilis.length; j++) {
            poilis[j].classList.remove("active")
          }
          this.classList.add("active")

          //从左往右点
          if (i > oldIndex) {
            leftToRight(i, oldIndex)
          }
          //从右往左点
          if (i < oldIndex) {
            rightToLeft(i, oldIndex)
          }
          oldIndex = autoIndex = i
        }
        poilis[i].addEventListener("mouseenter", function () {
          clearInterval(timer3D)
        }, false)
        poilis[i].addEventListener("mouseleave", function () {
          begin()
        }, false)
      }

      move()
      //自动轮播图
      function move() {
        begin()

        home.addEventListener("mouseenter", function () {
          clearInterval(timer3D)
        }, false)
        home.addEventListener("mouseleave", function () {
          begin()
        }, false)
      }

      //自动轮播定时器
      function begin() {
        clearInterval(timer3D)
        timer3D = setInterval(function () {
          autoIndex++
          if (autoIndex === piclis.length) autoIndex = 0

          for (let i = 0; i < poilis.length; i++) {
            poilis[i].classList.remove("active")
          }
          poilis[autoIndex].classList.add("active")

          leftToRight(autoIndex, oldIndex)

          oldIndex = autoIndex
        }, 3000);
      }

      //屏幕移动
      function leftToRight(newValue, oldValue) {
        removeAll(newValue)
        piclis[newValue].classList.add("rightShow")

        removeAll(oldIndex)
        piclis[oldIndex].classList.add("leftHide")
      }

      function rightToLeft(newValue, oldValue) {
        removeAll(newValue)
        piclis[newValue].classList.add("leftShow")

        removeAll(oldIndex)
        piclis[oldIndex].classList.add("rightHide")
      }

      function removeAll(i) {
        piclis[i].classList.remove("leftShow")
        piclis[i].classList.remove("rightShow")
        piclis[i].classList.remove("leftHide")
        piclis[i].classList.remove("rightHide")
      }
    }


    //第四屏图片效果
    picBoom()
    function picBoom() {
      for (let i = 0; i < auls.length; i++) {
        change(auls[i])
      }

      function change(ul) {
        let src = ul.dataset.src
        let w = ul.offsetWidth / 2
        let h = ul.offsetHeight / 2
        for (let i = 0; i < 4; i++) {
          let li = document.createElement("li")
          li.style.width = w + "px"
          li.style.height = h + "px"

          let img = document.createElement("img")
          img.style.left = -(i % 2) * w + "px"
          img.style.top = -Math.floor(i / 2) * h + "px"
          img.src = src

          li.appendChild(img)
          ul.appendChild(li)
        }

        ul.addEventListener("mouseenter", function () {
          let imgs = this.querySelectorAll("li>img")
          imgs[0].style.top = h + "px"
          imgs[1].style.left = -2 * w + "px"
          imgs[2].style.left = w + "px"
          imgs[3].style.top = -2 * h + "px"
        }, false)
        ul.addEventListener("mouseleave", function () {
          let imgs = this.querySelectorAll("li>img")
          imgs[0].style.top = 0 + "px"
          imgs[1].style.left = -w + "px"
          imgs[2].style.left = 0 + "px"
          imgs[3].style.top = -h + "px"
        }, false)
      }
    }


    //第五屏气泡
    let time1 = 0
    let time2 = 0
    bubbles()
    function bubbles() {
      let canvas = null
      for (let i = 0; i < tlis.length; i++) {
        tlis[i].addEventListener("mouseenter", function () {
          for (let j = 0; j < tlis.length; j++) {
            tlis[j].style.opacity = ".5"
          }
          this.style.opacity = "1"

          addCanvas()

          canvas.style.left = this.offsetLeft + "px"
          // canvas.style.top = 
        }, false)
      }

      tul.addEventListener("mouseleave", function () {
        for (let j = 0; j < tlis.length; j++) {
          tlis[j].style.opacity = "1"
        }
        canvas.remove()
        canvas = null
        clearInterval(time1)
        clearInterval(time2)
      }, false)

      function addCanvas() {
        if (!canvas) {
          canvas = document.createElement("canvas")
          canvas.width = tlis[0].offsetWidth
          canvas.height = tlis[0].offsetHeight

          t3.appendChild(canvas)
          makeBubbles()
        }
      }

      function makeBubbles() {
        let ctx
        if (canvas.getContext) {
          ctx = canvas.getContext("2d")

          let arr = []

          //将数组中的圆绘制到画布上
          time1 = setInterval(() => {
            ctx.clearRect(0, 0, canvas.width, canvas.height)
            //动画
            for (let i = 0; i < arr.length; i++) {

              arr[i].deg += 6

              arr[i].x = arr[i].startX + Math.sin(arr[i].deg * Math.PI / 180) * arr[i].step * 2
              arr[i].y = arr[i].startY - (arr[i].deg * Math.PI / 180) * arr[i].step

              if (arr[i].y <= 50) arr.splice(i, 1)
            }

            //绘制
            for (let i = 0; i < arr.length; i++) {
              ctx.save()
              ctx.fillStyle = `rgba(${arr[i].r}, ${arr[i].g}, ${arr[i].b}, ${arr[i].a})`
              ctx.beginPath()
              ctx.arc(arr[i].x, arr[i].y, arr[i].radius, 0, 2 * Math.PI)
              ctx.fill()
              ctx.restore()
            }
          }, 1000 / 50);

          //往arr中注入随机圆的信息
          time2 = setInterval(() => {
            let radius = Math.random() * 6 + 2

            let x = Math.random() * canvas.width
            let y = canvas.height - radius

            let r = Math.floor(Math.random() * 255)
            let g = Math.floor(Math.random() * 255)
            let b = Math.floor(Math.random() * 255)
            let a = 1

            let deg = 0

            let step = Math.random() * 50 + 10

            let startX = x
            let startY = y

            arr.push({ x, y, r, g, b, a, radius, deg, step, startX, startY })
          }, 50);
        }

      }
    }
  }

</script>

</html>